#!/bin/bash

# -----------------------------------------------------------------------------
# 功能: 自动化 Git提交流程 (add, commit, push) 来更新网站。
# 用法: ./update.sh "这里是你的提交信息"
# -----------------------------------------------------------------------------

# 如果任何命令执行失败，则立即退出脚本
set -e

# 1. 检查用户是否提供了提交信息
if [ -z "$1" ]; then
  # 如果 $1 (第一个参数) 是空的, 则打印错误信息并退出
  echo "🛑 错误: 请提供提交信息！"
  echo "用法: ./update.sh \"你的提交信息\""
  exit 1
fi

# 2. 执行 Git 命令
echo "🚀 开始更新网站..."

# 添加所有更改到暂存区
echo "➡️ 步骤 1/3: 添加所有文件 (git add .)"
git add .

# 提交更改，使用脚本的第一个参数作为提交信息
echo "✅ 步骤 2/3: 提交更改 (git commit)"
git commit -m "$1"

# 推送到远程仓库
echo "⬆️ 步骤 3/3: 推送到远程仓库 (git push)"
git push

echo "🎉 成功！网站已更新。"